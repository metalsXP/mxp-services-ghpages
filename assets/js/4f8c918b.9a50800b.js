"use strict";(self.webpackChunkubc_services=self.webpackChunkubc_services||[]).push([[4218],{1544:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_019-e27c229aae6444f7b18457b2d033adbe.png"},11158:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_017-bdd1e4ec11ba7a377cf5c15e5b3b49a9.png"},23536:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_024-d80e874886002c6952eccc2e9801322a.png"},27411:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_005-4c571b76ce3d34e6d448efda455531ee.png"},28453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var s=i(96540);const t={},a=s.createContext(t);function c(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),s.createElement(a.Provider,{value:n},e.children)}},29785:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_025-e42745d1a2a1ad6e21ed18084283847a.png"},35322:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"qppd","title":"QPPD","description":"QPPD linkage, master data, and synchronization","source":"@site/docs/products/mdVC/qppd.md","sourceDirName":".","slug":"/connectors/qppd/","permalink":"/products/mdVC/connectors/qppd/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"slug":"/connectors/qppd/","description":"QPPD linkage, master data, and synchronization"},"sidebar":"mdVC","previous":{"title":"CDS views","permalink":"/products/mdVC/connectors/cds/"}}');var t=i(74848),a=i(28453);const c={slug:"/connectors/qppd/",description:"QPPD linkage, master data, and synchronization"},o="QPPD",r={},l=[{value:"Characteristic Links",id:"characteristic-links",level:2},{value:"Specification Links",id:"specification-links",level:2},{value:"Synchronization Process",id:"synchronization-process",level:3},{value:"Synchronization Trigger and Target",id:"synchronization-trigger-and-target",level:4},{value:"Document Configuration",id:"document-configuration",level:5},{value:"Synchronization Configuration",id:"synchronization-configuration",level:5},{value:"Status Configuration",id:"status-configuration",level:5},{value:"Synchronization Back",id:"synchronization-back",level:4},{value:"Finish Configuration",id:"finish-configuration",level:4},{value:"Post-Processing: Release QPPD Draft",id:"post-processing-release-qppd-draft",level:4},{value:"Delete obsolete Objects",id:"delete-obsolete-objects",level:4},{value:"UI Extension",id:"ui-extension",level:3},{value:"Setup Summary",id:"setup-summary",level:3}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"qppd",children:"QPPD"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://qppd.info",children:"QPPD"}),' serves as a data modeling tool for master data and can also function as a central data hub hosting complex objects based on configuration values, such as the "technical order" for order dressing. This page explains how to link QPPD elements to characteristics and/or link QPPD objects to a configuration instance (both ways). Enhance your configuration logic and behavior with QPPD to elevate it to the next level.']}),"\n",(0,t.jsx)(n.h2,{id:"characteristic-links",children:"Characteristic Links"}),"\n",(0,t.jsxs)(n.p,{children:["When using QPPD to maintain master data, both elements and their values are typically managed directly within QPPD.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Product Form values",src:i(27411).A+"",width:"1027",height:"305"})]}),"\n",(0,t.jsxs)(n.p,{children:["In the AVC context, a characteristic must exist beforehand to be included in a configuration model. For example, the characteristic ",(0,t.jsx)(n.code,{children:"PRODUCT_FORM"})," needs to be created and added to the model."]}),"\n",(0,t.jsx)(n.p,{children:"Maintaining characteristic values in both AVC and QPPD is inefficient and error-prone. Therefore, QPPD should act as the single source of truth."}),"\n",(0,t.jsxs)(n.p,{children:["To support this, ",(0,t.jsx)(n.strong,{children:"mdVC"})," includes a pre-delivered implementation of the BADI ",(0,t.jsx)(n.code,{children:"vch_hl_es_core-vch_hl_md_domain_modify"}),", which uses the class ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_qppd_domain_modif"}),". This implementation checks whether a matching QPPD element exists for a given characteristic and, if so, supplies the QPPD-defined values for configuration use at runtime.",(0,t.jsx)(n.br,{}),"\n","Make sure to define suitable filter values when setting up the BADI."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"BADI implementation",src:i(61129).A+"",width:"1236",height:"465"})}),"\n",(0,t.jsx)(n.p,{children:"With this setup, there is no need to duplicate value maintenance in the characteristic itself \u2014 QPPD remains authoritative. However, the characteristic still needs to exist in the system to be added to the configuration model."}),"\n",(0,t.jsx)(n.h2,{id:"specification-links",children:"Specification Links"}),"\n",(0,t.jsx)(n.p,{children:'For complex calculations such as order dressing, calculating production alternatives, or other computations, it is beneficial to integrate and mirror some AVC values into QPPD in a separate Specification usually called a "Technical Order." This integration enables seamless, bidirectional synchronization of characteristic values between AVC and QPPD while ensuring configuration logic remains consistent and centrally governed in mdVC by reusing QPPD logic.'}),"\n",(0,t.jsx)(n.p,{children:"Due to the stateless nature of AVC and to allow users to modify specification values in QPPD, sophisticated draft handling is necessary. The draft handling described here focuses on sales documents where it's mandatory (sales document processing in SAP is stateful, AVC is stateless)."}),"\n",(0,t.jsx)(n.h3,{id:"synchronization-process",children:"Synchronization Process"}),"\n",(0,t.jsx)(n.mermaid,{value:"%%{init: {'theme':'neutral'}}%%\nflowchart TD\n    A[Create sales order item / enter configuration]\n    B[Change configuration values in AVC]\n    C{Relevant Characteristic changed?}\n    D[Prepare new QPPD draft: create/change]\n    E[Sync relevant + changed AVC chars to QPPD]\n    F[Trigger follow-up functions on QPPD draft]\n    G[Sync values + messages back to AVC]\n    H[Save QPPD draft]\n    I[End configuration processing]\n    J{Done with configuration?}\n    K[Finish configuration 'Done']\n    L[Set status 'to be released' + save QPPD draft]\n    M[Return to order processing, finish order entry]\n    N[Save order]\n    O[Promote QPPD drafts to 'released']\n\n    A --\x3e B\n    B --\x3e C\n    C --\x3e|Yes| D\n    C --\x3e|No| J\n    D --\x3e E\n    E --\x3e F\n    F --\x3e G\n    G --\x3e H\n    H --\x3e J\n    J --\x3e|No| B\n    J --\x3e|Yes| I\n    I --\x3e K\n    K --\x3e L\n    L --\x3e M\n    M --\x3e N\n    N --\x3e O"}),"\n",(0,t.jsx)(n.p,{children:"The following sections focuses on the key steps related to QPPD synchronization."}),"\n",(0,t.jsx)(n.h4,{id:"synchronization-trigger-and-target",children:"Synchronization Trigger and Target"}),"\n",(0,t.jsxs)(n.p,{children:["The initial synchronization is a ",(0,t.jsx)(n.a,{href:"/products/mdVC/usage/#task",children:"task"})," passed to the engine:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-abap",children:"new /mxp/vcha_cl_qp_va_sync( )\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{}),(0,t.jsxs)(n.p,{children:["In the standard implementation, log messages are synchronized back to AVC. Consider the ",(0,t.jsx)(n.a,{href:"/products/mdVC/usage/#best-practice",children:"Best practice"})," to derive status after QPPD synchronization completes."]})]}),"\n",(0,t.jsxs)(n.p,{children:["The enhancement spot ",(0,t.jsx)(n.code,{children:"/mxp/vcha_es_qp_sync"})," controls synchronization: configurations for QPPD specification types, synchronization object type definitions, and status definitions."]}),"\n",(0,t.jsx)(n.h5,{id:"document-configuration",children:"Document Configuration"}),"\n",(0,t.jsx)(n.p,{children:'To prevent issues like late numbering and manage "out-of-date" draft objects, two custom fields are required at the SAP sales order header level:'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Header Id"}),(0,t.jsx)(n.br,{}),"\n",'A "Character 22" field storing a unique header ID. It is filled immediately after sales order creation and never changed.']}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Activation Session Timestamp"}),(0,t.jsx)(n.br,{}),"\n","A timestamp field filled at the start of a sales order session. Internally used by the QPPD draft implementation to detect outdated drafts. Must be of type ",(0,t.jsx)(n.code,{children:"timestampl"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:['Best practice in S/4 systems is to use the "Custom Fields" app (',(0,t.jsx)(n.code,{children:"#CustomField-manage"}),"). For older releases, extend via developer extensibility. Only the Custom Fields app is considered clean-core compliant here.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Custom fields",src:i(79684).A+"",width:"1871",height:"285"})]}),"\n",(0,t.jsxs)(n.p,{children:["Recommended field names are ",(0,t.jsx)(n.code,{children:"ZZ1_HeaderId"})," and ",(0,t.jsx)(n.code,{children:"ZZ1_ActivationSession"}),". If these conflict with your naming conventions, implement the BADI ",(0,t.jsx)(n.code,{children:"/mxp/vcha_doc_link_config"})," to configure custom fields."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"BADI /mxp/vcha_doc_link_config",src:i(64959).A+"",width:"1231",height:"484"})}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{}),(0,t.jsx)(n.p,{children:"The logic for these fields is delivered with mdVC, but the fields themselves are not (to remain clean core compliant)."})]}),"\n",(0,t.jsxs)(n.p,{children:["The method ",(0,t.jsx)(n.code,{children:"get_header_fields"})," must be implemented:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-abap",children:"method /mxp/vcha_if_doc_link_config~get_header_fields.\n  e_header_id = 'ZZ1_HeaderId' ##NO_TEXT.\n  e_activation_session_ts = 'ZZ1_ActivationSession' ##NO_TEXT.\nendmethod.\n"})}),"\n",(0,t.jsx)(n.h5,{id:"synchronization-configuration",children:"Synchronization Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["The target QPPD object must be defined. The BADI ",(0,t.jsx)(n.code,{children:"/mxp/vcha_qp_sync_vart_config"})," configures the specification type, target object type, and follow-up actions on the QPPD object after synchronization. The method ",(0,t.jsx)(n.code,{children:"get_configuration"})," must be implemented; configuration can be plant-specific.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"get_configuration()",src:i(11158).A+"",width:"738",height:"373"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Specification Type Contract"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["No Specification Group should be assigned in Specification Type Customizing.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Specification Group",src:i(49937).A+"",width:"1165",height:"655"})]}),"\n",(0,t.jsxs)(n.li,{children:["An Object Type at header level must be assigned, listing all elements whose characteristics need synchronization from AVC instance. ",(0,t.jsx)(n.strong,{children:"The names must match."}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Object Type",src:i(1544).A+"",width:"856",height:"361"}),(0,t.jsx)(n.br,{}),"\n","All configuration values synchronize first to this object type, triggering follow-up actions."]}),"\n",(0,t.jsx)(n.li,{children:"Builder, Generation, and Follow-Up functions can be freely defined in QPPD style and configured within the BADI. They execute whenever a relevant synchronization element changes."}),"\n",(0,t.jsxs)(n.li,{children:["The status schema must follow the ",(0,t.jsx)(n.a,{href:"#status-configuration",children:"Status Configuration"})," described below."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Method Implementation"})}),"\n",(0,t.jsx)(n.p,{children:"The implementation may be plant-specific. A default implementation is provided:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Specification Type:"}),(0,t.jsx)(n.br,{}),"\n","Defaults to the QPPD Technical Order looked up by abbreviation ",(0,t.jsx)(n.code,{children:"TO"})," in Specification Type Customizing."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Object Type:"}),(0,t.jsx)(n.br,{}),"\n","Default implementation links to ",(0,t.jsx)(n.code,{children:"MDVC_CONFIG"}),"; keep this name if using the default."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:'Sales Document Key Element "ELEMENT_VBELN"'}),'\nThe element in given Object Type, where the sales document number will be set "after save". Due to late numbering, only active drafts will have the info consistently. This is just for information and visualization purposes. The default implementation states ',(0,t.jsx)(n.code,{children:"VBELN"})," as name. Clear when no synchronization needed."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Key Parts VC:"}),(0,t.jsx)(n.br,{}),"\n","The QPPD object is linked by its Name. The default derives the name from a characteristic ",(0,t.jsx)(n.code,{children:"MDVC_LINK_VNAME"}),". This value must be determined by a task before the actual QPPD synchronization. This is where the configured header ID is used."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"VBAK_Z_UUID"})," (customizable name) holds the header ID defined in ",(0,t.jsx)(n.a,{href:"#document-configuration",children:"Document Configuration"}),", made available to AVC since it only accesses configuration values.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"UUID Characteristic",src:i(77949).A+"",width:"828",height:"695"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"UUID Link",src:i(96742).A+"",width:"779",height:"475"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"POSNR"})," (customizable name) holds the sales order item number, also exposed to AVC.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"POSNR Link",src:i(35759).A+"",width:"816",height:"312"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"MDVC_LINK_VNAME"})," is calculated by a custom task.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"MDVC_LINK_VNAME",src:i(44916).A+"",width:"813",height:"749"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Example task configuration showing that ",(0,t.jsx)(n.code,{children:"lcl_calc_mdvc_link_vname"})," runs before QPPD synchronization:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-abap",children:"/mxp/vcha_cl_va_engine=>factory(\n  i_badi_implementation = me\n  i_explosion_date      = ref #( explosion_date )\n  i_hierarchy           = ref #( hierarchy )\n  i_characteristics     = ref #( characteristics )\n  i_values              = ref #( values )\n  i_bill_of_materials   = ref #( bill_of_materials )\n  i_assign_by_value     = ref #( assign_by_value )\n  i_assign_by_key       = ref #( assign_by_key )\n  i_unassign            = ref #( unassign )\n)->process( new /mxp/vcha_cl_va_task_composite( value #(\n              ( new lcl_calc_mdvc_link_vname( ) )\n              ( new /mxp/vcha_cl_qp_va_sync( ) )\n              ( new /mxp/vcha_cl_va_log_to_status( ) ) ) ) ).\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Example implementation of ",(0,t.jsx)(n.code,{children:"lcl_calc_mdvc_link_vname"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-abap",children:"class lcl_calc_mdvc_link_vname definition create public inheriting from /mxp/vcha_cl_va_task_simple.\n  public section.\n    methods /mxp/vcha_if_va_task~execute redefinition.\nendclass.\nclass lcl_calc_mdvc_link_vname implementation.\n  method /mxp/vcha_if_va_task~execute.\n    data(l_z_uuid) = i_engine->m_container->get_assigned_value_for_cstic(\n      i_engine->m_container->get_characteristic_by_name( i_instance_id = i_engine->m_container->m_root_instance_id\n                                                         i_cstic_name = 'VBAK_Z_UUID' )->key ).\n    data(l_posnr) = i_engine->m_container->get_assigned_value_for_cstic(\n      i_engine->m_container->get_characteristic_by_name( i_instance_id = i_engine->m_container->m_root_instance_id\n                                                         i_cstic_name = 'POSNR' )->key ).\n    check l_z_uuid is bound and l_posnr is bound.\n\n    i_engine->m_container->assign_value( value #( base corresponding #( i_engine->m_container->get_characteristic_by_name( i_instance_id = i_engine->m_container->m_root_instance_id\n                                                                                                                           i_cstic_name = 'MDVC_LINK_VNAME' )->key )\n                                                  value_string = /mxp/vcha_cl_qp_sd_key_util=>instance->key_for_item(\n                                                                   i_header_id = l_z_uuid->value_string\n                                                                   i_item      = conv #( l_posnr->value_int_min ) ) ) ).\n  endmethod.\nendclass.\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsx)(n.mdxAdmonitionTitle,{}),(0,t.jsxs)(n.p,{children:["You can skip calculating ",(0,t.jsx)(n.code,{children:"MDVC_LINK_VNAME"})," and instead concatenate via BADI settings (simpler but less flexible). At least a separate characteristic is needed for the ",(0,t.jsx)(n.a,{href:"#ui-extension",children:"AVC UI extension"})," which is why we decided to recommend this way."]})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Define follow-up actions"})," executed after any relevant configuration value change (object created or modified):","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Builder flag: whether to execute QPPD Builder"}),"\n",(0,t.jsx)(n.li,{children:"Generation flag: whether to suppress QPPD Global Generation"}),"\n",(0,t.jsxs)(n.li,{children:["Action name: which specific ",(0,t.jsx)(n.strong,{children:"VART function"})," to execute (see ",(0,t.jsx)(n.a,{href:"https://qppd.info/doc",children:"QPPD docs"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"status-configuration",children:"Status Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Multiple instances of a QPPD object for a configuration instance can exist. The objects are not versioned but are distinguished by their status. All share the same Name, as defined in ",(0,t.jsx)(n.a,{href:"#synchronization-configuration",children:"Synchronization configuration"}),". The BADI ",(0,t.jsx)(n.code,{children:"/mxp/vcha_qp_draft_status_conf"})," is used to configure the different statuses.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"BADI interface draft status config",src:i(23536).A+"",width:"741",height:"380"}),(0,t.jsx)(n.br,{}),"\n","A default implementation is provided by ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_qp_draft_stat_cfg"}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Draft object"}),(0,t.jsx)(n.br,{}),"\n",'The draft object exists "within a configuration" and can be discarded or adapted on each change.',(0,t.jsx)(n.br,{}),"\n","The default implementation creates the object with status ",(0,t.jsx)(n.code,{children:"IZQER"})," (in creation)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:'Draft object "to be released"'}),(0,t.jsx)(n.br,{}),"\n",'A draft object moves to "to be released" after the "Done" button is pressed in AVC, meaning it will be saved when the sales order is saved.',(0,t.jsx)(n.br,{}),"\n","The default implementation configures activity ",(0,t.jsx)(n.code,{children:"ZQFB"}),' ("release requested") to be executed, setting status ',(0,t.jsx)(n.code,{children:"IZQFB"})," according to status customizing."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Active object"}),(0,t.jsx)(n.br,{}),"\n",'A draft object "to be released" is promoted to "active" after saving the sales order as a post-processing step.',(0,t.jsx)(n.br,{}),"\n","Sales Order change events are fired by SAP standard, triggering class ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_qp_slo_evt_activ"})," as standard ",(0,t.jsx)(n.code,{children:"BGPF"}),".",(0,t.jsx)(n.br,{}),"\n","The default implementation configures activity ",(0,t.jsx)(n.code,{children:"ZQFR"}),' ("release") to be executed, setting status ',(0,t.jsx)(n.code,{children:"IZQFR"})," according to status customizing."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Inactive object"})," (previously active, but replaced)",(0,t.jsx)(n.br,{}),"\n",'An active object is marked inactive if another draft object "to be released" becomes active.',(0,t.jsx)(n.br,{}),"\n","The default implementation configures activity ",(0,t.jsx)(n.code,{children:"ZQLO"}),' ("mark for deletion") to be executed, setting status ',(0,t.jsx)(n.code,{children:"IZQLO"})," according to status customizing."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The default implementation must match the status schema of the configured Specification Type:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-abap",children:"method /mxp/vcha_if_qp_draft_stat_cfg~get_configuration.\n  r_result = value #( draft = value #( status = /sct/qp_cl_const=>status-in_creation\n                                       pending = value #( status = /sct/qp_cl_const=>status-release_requested\n                                                          activities-promote_to_active = /sct/qp_cl_const=>activity-release )\n                                       activities = value #( initialize = value #( )\n                                                             promote_to_pending = /sct/qp_cl_const=>activity-request_release ) )\n                      active = value #( status = /sct/qp_cl_const=>status-released\n                                        inactive = value #( status = /sct/qp_cl_const=>status-marked_for_deletion )\n                                        activities = value #( deactivate = /sct/qp_cl_const=>activity-delete ) ) ).\nendmethod.\n"})}),"\n",(0,t.jsx)(n.h4,{id:"synchronization-back",children:"Synchronization Back"}),"\n",(0,t.jsxs)(n.p,{children:["Because the structure of a source QPPD object may vary a lot between use cases, no BADI is provided ",(0,t.jsx)(n.strong,{children:"currently"})," for synchronization back. Instead, the method ",(0,t.jsx)(n.code,{children:"SYNCH_BACK_TO_VC"})," in the task class ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_qp_va_sync"})," is available for redefinition according to custom use cases. Additionally, all error messages within the object hierarchy will be synchronized to the AVC log, influencing status in the default handling (task ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_va_log_to_status"}),")."]}),"\n",(0,t.jsx)(n.h4,{id:"finish-configuration",children:"Finish Configuration"}),"\n",(0,t.jsxs)(n.p,{children:["Once the configuration is finished by clicking ",(0,t.jsx)(n.strong,{children:"Done"}),", the AVC BADI ",(0,t.jsx)(n.code,{children:"vch_hl_on_save"})," is triggered. The class ",(0,t.jsx)(n.code,{children:"/mxp/vcha_cl_qp_on_save"}),' can be added for a BADI implementation. It handles promoting the draft to the status "to be released".',(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"BADI vch_hl_on_save",src:i(29785).A+"",width:"1227",height:"470"}),(0,t.jsx)(n.br,{}),"\n","This status serves as an intermediate state while processing the sales document."]}),"\n",(0,t.jsx)(n.h4,{id:"post-processing-release-qppd-draft",children:"Post-Processing: Release QPPD Draft"}),"\n",(0,t.jsx)(n.p,{children:'As a post processing after saving the sales documents, all linked objects in status "to be released" will be promoted to "released". The Activation Session Timestamp will be considered, so that only relevant ones will be promoted:'}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:'The Activation Session Timestamp will be calculated once an object in status "to be released" exists for the document, but the timestamp is the beginning of the editing session, not the current one.'}),"\n",(0,t.jsx)(n.li,{children:'On Save, all objects which "last update" timestamp is higher than the Activation Session Timestamp will be considered as "to be promoted".'}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Objects which have errors will not be promoted to released nor considered as obsolete. They wait for manual editing (as the configuration does)."})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:['The relevant objects will be changed to "released".\nIf the field ',(0,t.jsx)(n.code,{children:"ELEMENT_VBELN"})," points to an element, the value will be set to the sales document. Due to late numbering, this is the first place where the numbers are available. The standard name for this element is ",(0,t.jsx)(n.code,{children:"VBELN"}),", see ",(0,t.jsx)(n.a,{href:"#synchronization-configuration",children:"Synchronization Configuration"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If any error occurs, the standard ",(0,t.jsx)(n.code,{children:"BGPF"})," unit will fail. Details are available in the standard transaction ",(0,t.jsx)(n.code,{children:"SBGRFCMON"}),". For more sophisticated logic, consider using an ",(0,t.jsx)(n.a,{href:"https://ubc.services/IO/documentation",children:"UBC interface"})," instead."]}),"\n",(0,t.jsx)(n.h4,{id:"delete-obsolete-objects",children:"Delete obsolete Objects"}),"\n",(0,t.jsx)(n.p,{children:"Scheduled as a regular job, the previously mentioned conditions will be checked and all drafts older than the specified lifetime will be deleted (e.g., incomplete configurations, cancelled editing sessions, etc.)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Application Job for QPPD draft cleanup",src:i(73698).A+"",width:"1865",height:"197"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Open the Fiori App for Application Jobs (#ApplicationJob-show)."}),"\n",(0,t.jsxs)(n.li,{children:["Create a new Application Job based on the template ",(0,t.jsx)(n.code,{children:"/mxp/vcha_qp_draft_cleanup"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Job Template /mxp/vcha_qp_draft_cleanup",src:i(94827).A+"",width:"1526",height:"442"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Choose a recurrence pattern; our recommendation is to schedule it once a day, which is sufficient."}),"\n",(0,t.jsxs)(n.li,{children:["Choose a lifetime of drafts in seconds; our recommendation is about ",(0,t.jsx)(n.code,{children:"86,400"})," (one day), meaning all obsolete drafts older than a day will be deleted."]}),"\n",(0,t.jsx)(n.li,{children:'The specification type will be defaulted with all your specification types according to the BADI implementation. From a default implementation perspective, this means "all Technical Orders".'}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"ui-extension",children:"UI Extension"}),"\n",(0,t.jsxs)(n.p,{children:['AVC provides a powerful UI extension approach, enabling, for example, the display of linked QPPD objects as a dedicated tab "group" in AVC. For more information on AVC UI extensions, see ',(0,t.jsx)(n.a,{href:"https://help.sap.com/docs/SAP_S4HANA_CLOUD/f369b2eff700401494ba6e7c9a573288/931576a8470e479ca11ca0b18d655092.html?locale=en-US",children:"SAP Help"})," and ",(0,t.jsx)(n.a,{href:"https://github.com/SAP-samples/s4hana-avc-ui-extension-template",children:"GitHub"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"UI Extension",src:i(68229).A+"",width:"1903",height:"574"})}),"\n",(0,t.jsx)(n.p,{children:"In brief, to display information of the linked QPPD object, the following configuration/development steps are required:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Develop your UI extension app as linked in the ",(0,t.jsx)(n.a,{href:"https://github.com/SAP-samples/s4hana-avc-ui-extension-template",children:"GitHub Repository"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Register an AVC UI extension and assign a name with Fiori app ",(0,t.jsx)(n.code,{children:"#VarCnfUserInterfaceExtension-manage"})]}),"\n",(0,t.jsxs)(n.li,{children:["Define the characteristic groups for your configuration model in Fiori app ",(0,t.jsx)(n.code,{children:"#VariantConfiguration-manageGroups"})," and assign characteristics.","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Make sure to add at least one characteristic; otherwise, the tab remains hidden."}),"\n",(0,t.jsxs)(n.li,{children:["It is recommended to calculate the linked specification name as a separate characteristic, as mentioned in ",(0,t.jsx)(n.a,{href:"#synchronization-configuration",children:"Synchronization configuration"}),", and add it to this group. The UI extension can then access this value and display the object's values by filtering on it."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:"Link the UI extension to this group by specifying your View Extension name in group header."}),"\n",(0,t.jsxs)(n.li,{children:["Assign the characteristic group to the configuration profile in Fiori app ",(0,t.jsx)(n.code,{children:"#VariantConfiguration-assignGroupsToProfile"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"For implementing your AVC UI extension:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Best practice is to expose parts of the QPPD object with OData and use Fiori Elements for displaying it.",(0,t.jsx)(n.br,{}),"\n","Consider using ",(0,t.jsx)(n.a,{href:"../../QPPD/GRO/GDD/documentation",children:"GDD"})," to generate semantic-rich CDS views as a basis for the custom Consumption View."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Be aware that draft objects must ",(0,t.jsx)(n.strong,{children:"not"})," be displayed in display mode, only in editing mode."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Unfortunately, it is not supported from the AVC UI Extension side to embed external UI5 libraries, thus it is currently not possible to offer a library for helper functions such as:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Jump to QPPD"}),"\n",(0,t.jsxs)(n.li,{children:["Display QPPD objects inline: UI and draft handling",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.img,{alt:"Display QPPD object",src:i(71871).A+"",width:"1888",height:"858"})]}),"\n",(0,t.jsx)(n.li,{children:"..."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Nevertheless, ",(0,t.jsxs)(n.strong,{children:["metals",(0,t.jsx)("sup",{children:"XP"})]}),' has some content available "pre-packaged". The current suggestion is to copy it as a "quick start" to your custom Extension project. This may change in the future if libraries become supported.']}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\ud83d\udcac Please reach out to the team of ",(0,t.jsxs)(n.strong,{children:["metals",(0,t.jsx)("sup",{children:"XP"})]})," for further details."]}),"\n",(0,t.jsx)(n.h3,{id:"setup-summary",children:"Setup Summary"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:['Add custom fields for "Header Id" and "Activation Session Timestamp" as described in ',(0,t.jsx)(n.a,{href:"#document-configuration",children:"Document configuration"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Perform QPPD and configuration customizing as described in ",(0,t.jsx)(n.a,{href:"#synchronization-configuration",children:"Synchronization configuration"})," and ",(0,t.jsx)(n.a,{href:"#status-configuration",children:"Status configuration"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Add the synchronization task to QPPD as per ",(0,t.jsx)(n.a,{href:"#synchronization-configuration",children:"Synchronization configuration"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Implement the BADI for promoting the draft as described in ",(0,t.jsx)(n.a,{href:"#finish-configuration",children:"Finish Configuration"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Schedule the regular job for deleting obsolete objects as described in ",(0,t.jsx)(n.a,{href:"#delete-obsolete-objects",children:"Delete obsolete Objects"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},35759:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_023-cb7bf3e0e4c0f5a30b9daf05d8f5e80d.png"},44916:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_020-1ba17e8823749b9162301abfe1eec932.png"},49937:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_018-cba449eff2d03aa8ed020ff94518d7ea.png"},61129:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_010-90c006a59c8b29a92e8f6e3422dfcfd5.png"},64959:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_016-bb5d14fe1e017523ad2bca78592e7c66.png"},68229:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_029-c15c7e31ab61b903ab404642a847e664.png"},71871:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_030-967eb0401dc07851398e8c17911a2794.png"},73698:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_026-c8996ede0a6d44a8adf4c983ef9e6ec3.png"},77949:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_021-958cdf1f5ad543dda6bb3462ee083574.png"},79684:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_015-c10f1378cb2f603c320ec3faa1c037c4.png"},94827:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_027-1ba0cde1b01257b9108ca9dc87ee446b.png"},96742:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_022-a1cc49ba4953135d75f2a4642e056630.png"}}]);