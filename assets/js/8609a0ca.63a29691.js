"use strict";(self.webpackChunkubc_services=self.webpackChunkubc_services||[]).push([[583],{13480:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/image_009-94ca80d17b65d182a081375212b4e26b.png"},22415:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>t,toc:()=>r});const t=JSON.parse('{"id":"IO/legacy_functions","title":"Legacy Functions","description":"Introduction","source":"@site/docs/products/UBC/IO/legacy_functions.md","sourceDirName":"IO","slug":"/IO/legacy_functions","permalink":"/products/UBC/IO/legacy_functions","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"ubc","previous":{"title":"I/O Monitoring (UBC.io)","permalink":"/products/UBC/IO/documentation"},"next":{"title":"RESTful webservices (UBC.rest)","permalink":"/products/UBC/REST/documentation"}}');var s=i(74848),o=i(28453);const l={},a="Legacy Functions",c={},r=[{value:"Introduction",id:"introduction",level:2},{value:"Customizing",id:"customizing",level:2},{value:"Functions",id:"functions",level:3},{value:"Function Name",id:"function-name",level:4},{value:"Field Mapping",id:"field-mapping",level:4},{value:"Acknowledge Function",id:"acknowledge-function",level:4},{value:"Multi-Step Function",id:"multi-step-function",level:3},{value:"Implementation",id:"implementation",level:2},{value:"Triggering Interfaces (Top-Level Function Module Only)",id:"triggering-interfaces-top-level-function-module-only",level:3},{value:"Multi-Step Interfaces",id:"multi-step-interfaces",level:3},{value:"Templates",id:"templates",level:3}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"legacy-functions",children:"Legacy Functions"})}),"\n",(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsxs)(n.p,{children:["UBC 1.32 introduces a new processing mode for UBC.io interfaces: the use of classes instead of function modules with macros.",(0,s.jsx)(n.br,{}),"\n","UBC.io is fully backward compatible, meaning all features described in the ",(0,s.jsx)(n.a,{href:"/products/UBC/IO/documentation",children:"general UBC.io documentation"})," are also supported with function modules. To keep the documentation clear, the delta customizing and implementation for interfaces using function modules are described here. Please make sure to read the ",(0,s.jsx)(n.a,{href:"/products/UBC/IO/documentation",children:"general UBC.io documentation"})," first."]}),"\n",(0,s.jsx)(n.p,{children:"The configuration is generally the same; the only difference is that if classes are activated for the system, classes are entered instead of function modules in various places during customizing. Additionally, some implementation considerations must be respected when using function modules."}),"\n",(0,s.jsxs)(n.p,{children:["UBC.io can handle both classes and function modules in parallel. For new interfaces, consider switching to classes instead of functions (contact the ",(0,s.jsxs)(n.a,{href:"https://www.metalsxp.com",children:["metals",(0,s.jsx)("sup",{children:"XP"})," team"]}),")."]}),"\n",(0,s.jsx)(n.h2,{id:"customizing",children:"Customizing"}),"\n",(0,s.jsx)(n.h3,{id:"functions",children:"Functions"}),"\n",(0,s.jsx)(n.h4,{id:"function-name",children:"Function Name"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Top Level Function Module",src:i(13480).A+"",width:"1136",height:"405"})}),"\n",(0,s.jsxs)(n.p,{children:["Specify a function module name as a top-level entry for the assignment to an interface. Please note that the function module must include simple calls at the beginning and end to be ready for use within UBC.io (see also ",(0,s.jsx)(n.a,{href:"#implementation",children:"Implementation"}),")."]}),"\n",(0,s.jsx)(n.h4,{id:"field-mapping",children:"Field Mapping"}),"\n",(0,s.jsxs)(n.p,{children:["If function modules are used, the messages table (from which the message status is derived and the application log is populated) must be defined in addition to the field mappings.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{alt:"Field mapping",src:i(54478).A+"",width:"1304",height:"401"}),(0,s.jsx)(n.br,{}),"\n","Define the path to the messages table (e.g., ",(0,s.jsx)(n.code,{children:"ET_RETURN"}),') and ensure the "contains messages" option is selected.']}),"\n",(0,s.jsx)(n.h4,{id:"acknowledge-function",children:"Acknowledge Function"}),"\n",(0,s.jsxs)(n.p,{children:["Here, you may optionally assign a function module name to be triggered when a message is acknowledged. The function module must have exactly the same signature (1:1) as the function specified in ",(0,s.jsx)(n.a,{href:"#function-name",children:"Function Name"}),". It should only contain logic, with no additional begin and end macro calls."]}),"\n",(0,s.jsx)(n.h3,{id:"multi-step-function",children:"Multi-Step Function"}),"\n",(0,s.jsxs)(n.p,{children:["In a multi-step scenario, a list of function modules must be assigned here.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.img,{alt:"Multi steps Customizing",src:i(28119).A+"",width:"1226",height:"408"})]}),"\n",(0,s.jsxs)(n.p,{children:["In this scenario, the top-level function module entered in the ",(0,s.jsx)(n.a,{href:"#functions",children:"Functions"})," section acts only as a wrapper and/or session initialization module. The function module must have exactly the same signature (1:1) as the function in ",(0,s.jsx)(n.a,{href:"#function-name",children:"Function Name"})," and contain only logic, with no additional begin and end macro calls."]}),"\n",(0,s.jsxs)(n.p,{children:["See implementation details in ",(0,s.jsx)(n.a,{href:"#multi-step-interfaces",children:"Multi-Step Interfaces"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"implementation",children:"Implementation"}),"\n",(0,s.jsx)(n.h3,{id:"triggering-interfaces-top-level-function-module-only",children:"Triggering Interfaces (Top-Level Function Module Only)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.a,{href:"#function-name",children:"Customizing"})," must be completed for your top-level function module.",(0,s.jsx)(n.br,{}),"\n","If multiple steps are used, you are free to define the relation through customizing."]}),"\n",(0,s.jsxs)(n.li,{children:["Your top-level function module must be called like any other function module in your code. Ensure that a ",(0,s.jsx)(n.code,{children:"COMMIT WORK"})," is included at the end of your program to trigger interface persistence."]}),"\n",(0,s.jsxs)(n.li,{children:["Include ",(0,s.jsx)(n.code,{children:"/UBC/IO_MACROS"})," in your function group/module."]}),"\n",(0,s.jsxs)(n.li,{children:["The first statement in the function module must be ",(0,s.jsx)(n.code,{children:"_ubc_io_begin ''."}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"The function module will exit immediately if not called by the framework and is asynchronous. The exporting parameters will remain empty."})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["The last statement in the function module must be ",(0,s.jsx)(n.code,{children:"_ubc_io_end ''."}),(0,s.jsx)(n.br,{}),"\n","Logging will be completed automatically by the framework."]}),"\n",(0,s.jsxs)(n.li,{children:["Ensure there are ",(0,s.jsx)(n.strong,{children:"no explicit commits"})," within your function module. Commit and rollback are controlled by the framework: an automatic commit is executed if successful, and a rollback if not.",(0,s.jsx)(n.br,{}),"\n","Avoid ",(0,s.jsx)(n.code,{children:"COMMIT WORK"}),", which would interfere with auto-restartability. If technically required (e.g., when posting multiple goods movements), consider using the ",(0,s.jsx)(n.a,{href:"/products/UBC/IO/documentation#multi-step-interfaces",children:"Multi-Step Approach"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"The rest of your function module can remain unchanged!"})}),"\n",(0,s.jsx)(n.p,{children:"Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-abap",children:'function /ubc/io_template_fm_single\n  importing\n    iv_matnr type matnr\n    iv_werks type werks_d\n  exporting\n    et_return type bapiret2_t\n  raising\n    /c09/cx_cio_persistency.\n\n\n\n  "include UBC.io macros\n  include /ubc/io_macros.\n\n  "clear exporting variables\n  clear et_return.\n\n  "UBC.io: begin\n  _ubc_io_begin \'\'.\n\n  "#TODO: actual implementation goes here, please make sure to embed the logic between "begin" and "end"\n  "make sure end will be called in any case, thus do not use e.g. RETURN statement\n  "if iv_matnr = \'4711\'.\n  "endif.\n\n  "UBC.io: finish\n  _ubc_io_end \'\'.\nendfunction.\n'})}),"\n",(0,s.jsx)(n.p,{children:"And the actuall call:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-abap",children:"call function '/UBC/IO_TEMPLATE_FM_SINGLE'\n  exporting\n    iv_matnr  = '4711'\n    iv_werks  = '123'.\ncommit work.\n"})}),"\n",(0,s.jsx)(n.h3,{id:"multi-step-interfaces",children:"Multi-Step Interfaces"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The top-level function module specified in ",(0,s.jsx)(n.a,{href:"#functions",children:"Functions"})," must adhere to the previously described contract; see ",(0,s.jsx)(n.a,{href:"#triggering-interfaces-top-level-function-module-only",children:"Triggering Interfaces"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:['Every "Step Function Module" ',(0,s.jsx)(n.strong,{children:"must not"})," include any macros. It is controlled by the top-level function module (begin and end) and should only contain business logic."]}),"\n",(0,s.jsx)(n.li,{children:'The top-level function module may optionally include initialization routines between the "begin" and "end" macros.'}),"\n",(0,s.jsxs)(n.li,{children:["Ensure that your Step Function Module does not contain any ",(0,s.jsx)(n.code,{children:"COMMIT WORK"})," or ",(0,s.jsx)(n.code,{children:"ROLLBACK WORK"}),", as this would break auto-restartability."]}),"\n",(0,s.jsxs)(n.li,{children:["Your Step Function Module must have ",(0,s.jsx)(n.strong,{children:"exactly the same"})," function module signature as your top-level function module.",(0,s.jsx)(n.br,{}),"\n","If you need to exchange information between steps, consider using an optional changing parameter (add it to all involved function modules).",(0,s.jsx)(n.br,{}),"\n","The parameters will be passed to the next function."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"templates",children:"Templates"}),"\n",(0,s.jsxs)(n.p,{children:["To speed up development, ABAP templates are available for single functions and functions with multiple steps/LUWs.",(0,s.jsx)(n.br,{}),"\n","See package ",(0,s.jsx)(n.code,{children:"/UBC/IO_TEMPLATE_LEGACY"}),"."]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28119:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/image_011-efbfeb20340f96f5e5fb2b9b294ab4ef.png"},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var t=i(96540);const s={},o=t.createContext(s);function l(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(o.Provider,{value:n},e.children)}},54478:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/image_010-5771e9290810f109e8e149979ea25cd8.png"}}]);